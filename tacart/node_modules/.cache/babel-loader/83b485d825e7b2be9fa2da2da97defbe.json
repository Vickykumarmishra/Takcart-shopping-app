{"ast":null,"code":"import { appearStoreId } from './store-id.mjs';\nimport { animateStyle } from '../waapi/index.mjs';\nimport { optimizedAppearDataId } from './data-id.mjs';\nimport { handoffOptimizedAppearAnimation } from './handoff.mjs';\nimport { appearAnimationStore } from './store.mjs';\nimport { noop } from '../../utils/noop.mjs';\nfunction startOptimizedAppearAnimation(element, name, keyframes, options, onReady) {\n  var id = element.dataset[optimizedAppearDataId];\n  if (!id) return;\n  window.HandoffAppearAnimations = handoffOptimizedAppearAnimation;\n  var storeId = appearStoreId(id, name);\n  /**\n   * Use a dummy animation to detect when Chrome is ready to start\n   * painting the page and hold off from triggering the real animation\n   * until then.\n   *\n   * https://bugs.chromium.org/p/chromium/issues/detail?id=1406850\n   */\n  var readyAnimation = animateStyle(element, name, [keyframes[0], keyframes[0]],\n  /**\n   * 10 secs is basically just a super-safe duration to give Chrome\n   * long enough to get the animation ready.\n   */\n  {\n    duration: 10000,\n    ease: \"linear\"\n  });\n  appearAnimationStore.set(storeId, {\n    animation: readyAnimation,\n    startTime: null\n  });\n  var startAnimation = function startAnimation() {\n    readyAnimation.cancel();\n    var appearAnimation = animateStyle(element, name, keyframes, options);\n    if (document.timeline) {\n      appearAnimation.startTime = document.timeline.currentTime;\n    }\n    appearAnimationStore.set(storeId, {\n      animation: appearAnimation,\n      startTime: performance.now()\n    });\n    if (onReady) onReady(appearAnimation);\n  };\n  if (readyAnimation.ready) {\n    readyAnimation.ready.then(startAnimation).catch(noop);\n  } else {\n    startAnimation();\n  }\n}\nexport { startOptimizedAppearAnimation };","map":null,"metadata":{},"sourceType":"module"}